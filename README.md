# BannerGrab

## 说明

高性能服务指纹抓取

## 使用

```
$ ./banner_grab -h
Usage of ./banner_grab:
  -banner int
    	banner size (default 1024)
  -connect duration
    	connect timeout (default 1s)
  -readWrite duration
    	read write timeout (default 1s)
  -ssl duration
    	ssl handshake timeout (default 1s)
  -threads int
    	threads (default 1024)

$ echo '{"ip": "220.181.57.216", "port": 80, "protocol": "tcp"}' |./banner_grab |jq
{
  "ip": "220.181.57.216",
  "port": 80,
  "protocol": "tcp",
  "ssl": false,
  "certificates": [],
  "banner": {
    "source": "http",
    "banner": "SFRUUC8xLjEgMjAwIE9LDQpEYXRlOiBTYXQsIDI5IFNlcCAyMDE4IDA0OjQ1OjIyIEdNVA0KU2VydmVyOiBBcGFjaGUNCkxhc3QtTW9kaWZpZWQ6IFR1ZSwgMTIgSmFuIDIwMTAgMTM6NDg6MDAgR01UDQpFVGFnOiAiNTEtNDdjZjdlNmVlODQwMCINCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpDb250ZW50LUxlbmd0aDogODENCkNhY2hlLUNvbnRyb2w6IG1heC1hZ2U9ODY0MDANCkV4cGlyZXM6IFN1biwgMzAgU2VwIDIwMTggMDQ6NDU6MjIgR01UDQpDb25uZWN0aW9uOiBDbG9zZQ0KQ29udGVudC1UeXBlOiB0ZXh0L2h0bWwNCg0KPGh0bWw+CjxtZXRhIGh0dHAtZXF1aXY9InJlZnJlc2giIGNvbnRlbnQ9IjA7dXJsPWh0dHA6Ly93d3cuYmFpZHUuY29tLyI+CjwvaHRtbD4K"
  }
}

$ echo '{"ip": "220.181.57.216", "port": 443, "protocol": "tcp"}' |./banner_grab |jq
{
  "ip": "220.181.57.216",
  "port": 443,
  "protocol": "tcp",
  "ssl": true,
  "certificates": [
    "MIIHKDCCBhCgAwIBAgIQCdi4dJ3JNIJeg1mgZUbAmTANBgkqhkiG9w0BAQsFADBNMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMScwJQYDVQQDEx5EaWdpQ2VydCBTSEEyIFNlY3VyZSBTZXJ2ZXIgQ0EwHhcNMTgwNDAzMDAwMDAwWhcNMTkwNDAzMTIwMDAwWjCBmDELMAkGA1UEBhMCQ04xEDAOBgNVBAcTB0JlaWppbmcxOTA3BgNVBAoTMEJlaUppbmcgQmFpZHUgTmV0Y29tIFNjaWVuY2UgVGVjaG5vbG9neSBDby4sIEx0ZDElMCMGA1UECxMcc2VydmljZSBvcGVyYXRpb24gZGVwYXJ0bWVudDEVMBMGA1UEAxMMd3d3LmJhaWR1LmNuMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxfCR6IaIbCkh5kwSSkcvj7DDjx4eGMeqPDNoGdPVZ62muX6gLIPKRqvpcDD9Dxz86oxgh58tWJGnSXk4gaeKOpAfm8JoxegrRmE5uOMjM+F1U50rFscxw9h1czPkPpwLV3l+zP8kwVLtWLuesRMVpPgyFXr5W5db6r1Ixh0YjoQB1S1OalZhj/7BKnMpj/Fg3/tAqu0ONBDMcJmD4e3Qgupd8PmZmidcwWGb3JW7tBm4y78CKQFWb6eW5zzEwPnKHPJbHwmOTHgK0V03eXShlLVbURytO78r69P5Zp6bbVS8AK7e220kIOhDodV/AX6jAxIIvdiBD649se7eqcgpwQIDAQABo4IDtjCCA7IwHwYDVR0jBBgwFoAUD4BhHIIxYdUvKOeNRji0LOHG2eIwHQYDVR0OBBYEFHcpf65dezsVZo5DXWOZavbPOoc4MIH0BgNVHREEgewwgemCCGJhaWR1LmNuggliYWlkdS5jb22CDGJhaWR1LmNvbS5jboILdy5iYWlkdS5jb22CDHd3LmJhaWR1LmNvbYIMd3d3LmJhaWR1LmNughB3d3cuYmFpZHUuY29tLmNughB3d3cuYmFpZHUuY29tLmhrggx3d3cuYmFpZHUuaGuCEHd3dy5iYWlkdS5uZXQuYXWCEHd3dy5iYWlkdS5uZXQucGiCEHd3dy5iYWlkdS5uZXQudHeCEHd3dy5iYWlkdS5uZXQudm6CDnd3d3cuYmFpZHUuY29tghF3d3d3LmJhaWR1LmNvbS5jbjAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMGsGA1UdHwRkMGIwL6AtoCuGKWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9zc2NhLXNoYTItZzYuY3JsMC+gLaArhilodHRwOi8vY3JsNC5kaWdpY2VydC5jb20vc3NjYS1zaGEyLWc2LmNybDBMBgNVHSAERTBDMDcGCWCGSAGG/WwBATAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BTMAgGBmeBDAECAjB8BggrBgEFBQcBAQRwMG4wJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBGBggrBgEFBQcwAoY6aHR0cDovL2NhY2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0U0hBMlNlY3VyZVNlcnZlckNBLmNydDAJBgNVHRMEAjAAMIIBBAYKKwYBBAHWeQIEAgSB9QSB8gDwAHYApLkJkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFiinOKcwAABAMARzBFAiEAyQLGZj3uzygOaWt53R1Ji3RDCc7Lz6HUaEWr/zFmiUICIBCLM91ecE3U2cNutgS1utN3zjDEMPNHmAwUOiRMXbWPAHYAb1N2rDHwMRnYmQCkURX/dxUcEdkCwQApBo2yCJo32RMAAAFiinOLnwAABAMARzBFAiAoUXB7X5N85XIw/bVouSFq7xReRS89hIeGELWODBAXmAIhAMUcYHdSnypC2hr17OzaP742IV9CM1nFczFNdargkkbxMA0GCSqGSIb3DQEBCwUAA4IBAQAX+Sc3rS9iZBPvqdL5mLAXaprHwR4L/hSNkknwkmh0+JJlRYrXu0T9qecUXDst093HsTYkMIxicSXga2wW+SNTZLj/6vXrCZs39ZvIZYAj2L0m01EuVHsTLIKVoxi+aZpXfUNBWRDB1XAnZbNDwWl7mQtAwr3/wIJnGtPuSHzWYkY4Aoi5UjMnh0I3ndljqTKBTCi0F7iwcptcyihwsKojdfOBF4WbwQLA/JMh2fhF062zUWCz3L76zmzQ6007IIUurH0/5Yc3daUgxeV8J8qHVo7NOwbaPnrq1gTfzO0nw5oFtyJeqgyQ/BCaTXxyauDbprSPrPhAyWO3cT1sMaqu",
    "MIIElDCCA3ygAwIBAgIQAf2j627KdciIQ4tyS8+8kTANBgkqhkiG9w0BAQsFADBhMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBDQTAeFw0xMzAzMDgxMjAwMDBaFw0yMzAzMDgxMjAwMDBaME0xCzAJBgNVBAYTAlVTMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxJzAlBgNVBAMTHkRpZ2lDZXJ0IFNIQTIgU2VjdXJlIFNlcnZlciBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANyuWJBNwcQwFZA1W248ghX1LFy949v/cUP6ZCWA1O4Yok3wZtAKc24RmDYXZK83nf36QYSvx6+M/hpzTc8zl5CilodTgyu5pnVILR1WN3vaMTIa16yrBvSqXUu3R0bdKpPDkC55gIDvEwRqFDu1m5K+wgdlTvza/P96rtxcflUxDOg5B6TXvi/TC2rSsd9f/ld0Uzs1gN2ujkSYs58O09rg1/RrKatEp0tYhG2SS4HD2nOLEpdIkARFdRrdNzGXkujNVA075ME/OV4uuPNcfhCOhkEAjUVmR7ChZc6gqikJTvOX6+guqw9ypzAO+sf0/RR3w6RbKFfCs/mC/bdFWJsCAwEAAaOCAVowggFWMBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgGGMDQGCCsGAQUFBwEBBCgwJjAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tMHsGA1UdHwR0MHIwN6A1oDOGMWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RDQS5jcmwwN6A1oDOGMWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RDQS5jcmwwPQYDVR0gBDYwNDAyBgRVHSAAMCowKAYIKwYBBQUHAgEWHGh0dHBzOi8vd3d3LmRpZ2ljZXJ0LmNvbS9DUFMwHQYDVR0OBBYEFA+AYRyCMWHVLyjnjUY4tCzhxtniMB8GA1UdIwQYMBaAFAPeUDVW0Uy7ZvCj4hsbw5eyPdFVMA0GCSqGSIb3DQEBCwUAA4IBAQAjPt9L0jFCpbZ+QlwaRMxp0Wi0XUvgBCFsS+JtzLHgl4+mUwnNqipl5TlPHoOlblyYoiQm5vuh7ZPHLgLGTUq/sELfeNqzqPlt/yGFUzZgTHbO7Djc1lGA8MXW5dRNJ2Srm8c+cftIl7gzbckTB+6WohsYFfZcTEDts8Ls/3HB40f/1LkAtDdC2iDJ6m6K7hQGrn2iWZiIqBtvLfTyyRRfJs8sjX7tN8Cp1Tm5gr8ZDOo0rwAhaPitc+LJMto4JQtV05od8GiG7S5BNO98pVAdvzr508EIDObtHopYJeS4d60tbvVS3bR0j6tJLp07kzQoH3jOlOrHvdPJbRzeXDLz"
  ],
  "banner": {
    "source": "http",
    "banner": "SFRUUC8xLjEgNDAwIEJhZCBSZXF1ZXN0DQpTZXJ2ZXI6IGJmZS8xLjAuOC4xOA0KRGF0ZTogU2F0LCAyOSBTZXAgMjAxOCAwNDo0NTo0NiBHTVQNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sDQpDb250ZW50LUxlbmd0aDogMjcxDQpDb25uZWN0aW9uOiBjbG9zZQ0KDQo8aHRtbD4NCjxoZWFkPjx0aXRsZT40MDAgVGhlIHBsYWluIEhUVFAgcmVxdWVzdCB3YXMgc2VudCB0byBIVFRQUyBwb3J0PC90aXRsZT48L2hlYWQ+DQo8Ym9keSBiZ2NvbG9yPSJ3aGl0ZSI+DQo8Y2VudGVyPjxoMT40MDAgQmFkIFJlcXVlc3Q8L2gxPjwvY2VudGVyPg0KPGNlbnRlcj5UaGUgcGxhaW4gSFRUUCByZXF1ZXN0IHdhcyBzZW50IHRvIEhUVFBTIHBvcnQ8L2NlbnRlcj4NCjxocj48Y2VudGVyPmJmZS8xLjAuOC4xODwvY2VudGVyPg0KPC9ib2R5Pg0KPC9odG1sPg0K"
  }
}
```
